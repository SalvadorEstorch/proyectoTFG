<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{master.html}">
<head>
<meta charset="utf-8">
<title>Administrar Eventos</title>
</head>
<body sec:authorize="hasRole('ROLE_ADMIN')">

	<div layout:fragment="content">
		<h2>Eventos</h2>
		<div class="text-end">
			<a href="/admin/eventos/nuevo" class="btn btn-primary mb-3">
				Agregar evento </a>
		</div>
		<table class="table table-hover">
			<thead>
				<tr>
					<th></th>
					<th>Evento</th>
					<th>Fecha</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="evento : ${eventos}" th:object="${evento}">
					<td style="width: 150px;"><a
						th:href="@{/assets/{filename}(filename=*{rutaPortada})}"
						data-fancybox> <img
							th:src="@{/assets/{filename}(filename=*{rutaPortada})}" alt=""
							class="img-thumbnail w-100">
					</a></td>
					<td>
						<div th:text="*{nombreE}" class="fs-5 fw-bold"></div>
						<p th:text="*{descripcionE}"></p>

					</td>
					<td th:text="*{#temporals.format(fechaInicio,'dd/MM/yyyy')}"></td>
					<td class="text-end">
						<div class="btn">
							<a th:href="@{/admin/eventos/{id}/desactivar(id=*{idEvento})}"
								th:if="${evento.activo == 1}" class="btn btn-outline-danger">Desactivar</a>

							<a th:href="@{/admin/eventos/{id}/activar(id=*{idEvento})}"
								th:if="${evento.activo == 0}" class="btn btn-success">Activar</a>
						</div>
						<div class="btn">
							<a th:href="@{/admin/eventos/{id}/editar(id=*{idEvento})}"
								class="btn btn-primary">Editar</a>
						</div>
						<div class="btn">
							<a href="javascript:void(0)" class="btn btn-danger"
								th:onclick="'eliminarEvento(' + *{idEvento} +')'">Eliminar</a>
								<form th:id="'eliminarEventoForm' + *{idEvento}" th:action="@{/admin/eventos/{id}/eliminar(id=*{idEvento})}" method="post" class="d-none">
					   </form>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
		<div class="row mt-5" th:with="page=${eventos}">
			<div class="col-sm-6">
				<div sd:pagination-sumary></div>
				<div class="col-sm-6">
					<nav>
						<ul class="pagination" sd:pagination="full"></ul>
					</nav>
				</div>
			</div>
		</div>
	</div>

	<div layout:fragment="scripts">
		<script>
			function eliminarEvento(id) {
				if (!confirm('¿Estás seguro de eliminar este evento?')) {
					return;
				}
				$('#eliminarEventoForm' + id).submit();
			}
		</script>
	</div>

</body>
</html>